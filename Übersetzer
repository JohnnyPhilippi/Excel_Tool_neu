import pandas as pd
from deep_translator import GoogleTranslator

def translate_excel_columns(file_path, columns_to_translate, output_path):
    # Load Excel file
    df = pd.read_excel(file_path)
    
    # Function to translate text
    def translate_text(text):
        if isinstance(text, str):  # Ensure content is a string
            return GoogleTranslator(source='en', target='de').translate(text)
        return text
    
    # Apply translation only to selected columns
    for column in columns_to_translate:
        if column in df.columns:
            df[column] = df[column].apply(translate_text)
    
    # Save translated file
    df.to_excel(output_path, index=False)
    print(f'Translated file saved to {output_path}')

# Example usage
file_path = 'input_file.xlsx'
columns_to_translate = ['Name', 'Description', 'Color']  # Columns to translate
output_path = 'translated_file.xlsx'

translate_excel_columns(file_path, columns_to_translate, output_path)
